# h4

## x)

Hammond 2022:

- The video shows a walkthrough of John Hammond using tools like Ghidra to complete a ctf challenge!

- In the video, John goes in depth on how the logic works behind the program and pairs the explenation
well with Ghidra. This video helped a ton on the next exercises!

## a) and b)
Ghidra up and running!

<img width="1024" height="768" alt="image" src="https://github.com/user-attachments/assets/93d73430-7602-4207-bffa-0349bfb749bc" />

I renamed the function name from "main" to "pwordfetch" and the "iVar1" variable to "pwordcompare".
You can see the strcmp uses the pwordcompare variable in the to see that the input __doesn't__ match the password string. If the input __doesn't__ match the
pwordcompare value, the program returns "Yes! That\'s the password. FLAG{Tero-0e3bed0a89d8851da933c64fefad4ff2}" and if the input __does__ match the value, it means the password is false and
it returns "Sorry, no bonus.".

## c) 

To change the logic of the program, we must understand it. In the binary you can see that when the input is set to JNZ (not equal to zero) and the input is sala-hakkeri-321, the program presents you with the flag.
We need to reverse this so that the strcmp returns 0, when the password is anything but the correct one.

<img width="208" height="23" alt="image" src="https://github.com/user-attachments/assets/58a63e4f-bf1a-469f-b4ef-07215e62dd9d" />

In order to change this, we change the JNZ (not equal) to JZ (equal), like so!

<img width="208" height="23" alt="image" src="https://github.com/user-attachments/assets/5f05814a-70af-402e-a74e-a08fa78e8b8f" />

Here we see the program working :P

<img width="639" height="83" alt="image" src="https://github.com/user-attachments/assets/f7d73340-80bb-44b7-bf79-97297944f427" />

## d), e) and e(e))                                            

I'm not sure if I understood the exercise, but I think the aim is not to change anything, but to understand what the program uses to return the value 0.

In the case of crackme01, the program returns 0 when the input matches the string "password1" as shown here.

<img width="522" height="457" alt="image" src="https://github.com/user-attachments/assets/3a9089f5-f556-47c0-9375-41e389f454d0" />

In the case of crackme01e the input must match "slm!paas.k" in order for the program to return with 0 as shown here.

<img width="472" height="462" alt="image" src="https://github.com/user-attachments/assets/3de8ce37-b28b-4812-8f51-7f7bbd476802" />

In hindsight i realized that i probably had to navigate through the binary and not look at the Ghidra decompiler. Would be helpful towards the future to understand and map the logic behind the program. I'll have to do a few of them with the right method. :P

Sources: 

https://terokarvinen.com/application-hacking/

https://www.youtube.com/watch?v=oTD_ki86c9I

https://www.youtube.com/watch?v=fTGTnrgjuGA

Little bit of Gemini 3.0 with very vague prompts to help with small hicups, always made sure to refuse the answer in the prompt and to explain the steps very carefully :P

Edit: Forgot to do crackme02. Looked through it after and read other's reports about it. Understood the logic, but would've been a two hour headache that probably wouldn't have been solved. so maybe I keep my peace :P













